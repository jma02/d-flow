Train set shape: torch.Size([16000, 1, 64, 64])
Validation set shape: torch.Size([2000, 1, 64, 64])
Test set shape: torch.Size([2000, 1, 64, 64])
Epochs:   1%|â–Š                                                                                                                                 | 1/151 [01:01<2:34:55, 61.97s/it]
Traceback (most recent call last):
Step: 99 (0) | Loss: 1.77676 | Grad: 11.81953 | Lr: 1.110e-06
Generating samples at epoch 0
Step: 199 (1) | Loss: 1.63967 | Grad: 11.18828 | Lr: 2.221e-06
  File "/home/johnma/d-flow/train.py", line 112, in <module>
    loss = loss_fn(x) / accumulation_steps
  File "/home/johnma/d-flow/train.py", line 33, in loss_fn
    pred_vel = model(xt, t)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/unet/default.py", line 80, in forward
    h = self.up[i][1](torch.cat((h, down_path.pop()), dim=1), emb)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/unet/modules.py", line 112, in forward
    emb = self.cond_block(emb)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/unet/modules.py", line 95, in forward
    emb = self.proj(emb)[:, :, None, None]
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
