Train set shape: torch.Size([16000, 1, 64, 64])
Validation set shape: torch.Size([2000, 1, 64, 64])
Test set shape: torch.Size([2000, 1, 64, 64])
Epochs:   3%|████▌                                                                                                                                         | 4/126 [03:19<1:34:14, 46.35s/it]
Epoch 5: 197it [00:07, 25.35it/s] 
Step: 99 (0) | Loss: 1.22507 | Grad: 20.14791 | Lr: 1.110e-06
Step: 199 (0) | Loss: 0.54146 | Grad: 5.28503 | Lr: 2.221e-06
Step: 299 (0) | Loss: 0.19308 | Grad: 0.69708 | Lr: 3.332e-06
Step: 399 (0) | Loss: 0.17662 | Grad: 0.81457 | Lr: 4.443e-06
Step: 499 (0) | Loss: 0.15979 | Grad: 1.02170 | Lr: 5.554e-06
Generating samples at epoch 0
Checkpoint saved at step 500, epoch 0
Step: 599 (1) | Loss: 0.16760 | Grad: 1.73224 | Lr: 6.665e-06
Step: 699 (1) | Loss: 0.10720 | Grad: 1.50916 | Lr: 7.777e-06
Step: 799 (1) | Loss: 0.10014 | Grad: 2.62805 | Lr: 8.888e-06
Step: 899 (1) | Loss: 0.06914 | Grad: 1.13393 | Lr: 9.999e-06
Step: 999 (1) | Loss: 0.11034 | Grad: 1.08095 | Lr: 1.111e-05
Generating samples at epoch 1
Step: 1099 (2) | Loss: 0.07205 | Grad: 1.97521 | Lr: 1.222e-05
Step: 1199 (2) | Loss: 0.08051 | Grad: 1.86078 | Lr: 1.333e-05
Step: 1299 (2) | Loss: 0.08984 | Grad: 0.75802 | Lr: 1.444e-05
Step: 1399 (2) | Loss: 0.09064 | Grad: 0.53396 | Lr: 1.555e-05
Step: 1499 (2) | Loss: 0.07082 | Grad: 0.66112 | Lr: 1.667e-05
Generating samples at epoch 2
Step: 1599 (3) | Loss: 0.06266 | Grad: 1.82609 | Lr: 1.778e-05
Step: 1699 (3) | Loss: 0.07212 | Grad: 0.77752 | Lr: 1.889e-05
Step: 1799 (3) | Loss: 0.04613 | Grad: 1.03658 | Lr: 2.000e-05
Step: 1899 (3) | Loss: 0.05023 | Grad: 1.03791 | Lr: 2.111e-05
Step: 1999 (3) | Loss: 0.08073 | Grad: 0.42996 | Lr: 2.222e-05
Generating samples at epoch 3
Step: 2099 (4) | Loss: 0.06669 | Grad: 1.07596 | Lr: 2.333e-05
Step: 2199 (4) | Loss: 0.04578 | Grad: 0.31877 | Lr: 2.444e-05
Step: 2299 (4) | Loss: 0.05029 | Grad: 0.82028 | Lr: 2.555e-05
Step: 2399 (4) | Loss: 0.08036 | Grad: 0.33973 | Lr: 2.667e-05
Step: 2499 (4) | Loss: 0.04272 | Grad: 0.64697 | Lr: 2.778e-05
Generating samples at epoch 4
Step: 2599 (5) | Loss: 0.04041 | Grad: 1.14597 | Lr: 2.889e-05
Step: 2699 (5) | Loss: 0.04649 | Grad: 0.53515 | Lr: 3.000e-05
Step: 2799 (5) | Loss: 0.06659 | Grad: 0.41413 | Lr: 3.111e-05
Step: 2899 (5) | Loss: 0.05409 | Grad: 0.60212 | Lr: 3.222e-05
Step: 2999 (5) | Loss: 0.05362 | Grad: 0.90928 | Lr: 3.333e-05
Generating samples at epoch 5
Step: 3099 (6) | Loss: 0.05386 | Grad: 0.50708 | Lr: 3.444e-05
Step: 3199 (6) | Loss: 0.05183 | Grad: 0.68310 | Lr: 3.555e-05
Step: 3299 (6) | Loss: 0.04362 | Grad: 0.63852 | Lr: 3.666e-05
Step: 3399 (6) | Loss: 0.03303 | Grad: 0.36360 | Lr: 3.778e-05
Step: 3499 (6) | Loss: 0.04676 | Grad: 0.71297 | Lr: 3.889e-05
Generating samples at epoch 6
Step: 3599 (7) | Loss: 0.05191 | Grad: 0.64383 | Lr: 4.000e-05
Step: 3699 (7) | Loss: 0.05399 | Grad: 0.35561 | Lr: 4.111e-05
Step: 3799 (7) | Loss: 0.03503 | Grad: 0.73350 | Lr: 4.222e-05
Step: 3899 (7) | Loss: 0.02905 | Grad: 0.29385 | Lr: 4.333e-05
Step: 3999 (7) | Loss: 0.04043 | Grad: 0.28108 | Lr: 4.444e-05
Generating samples at epoch 7
  File "/usr/lib64/python3.9/threading.py", line 980, in _bootstrap_inner
    self.run()
  File "/usr/lib64/python3.9/threading.py", line 917, in run
    self._target(*self._args, **self._kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 61, in _pin_memory_loop
    do_one_step()
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/utils/data/_utils/pin_memory.py", line 37, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/usr/lib64/python3.9/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/multiprocessing/reductions.py", line 541, in rebuild_storage_fd
    fd = df.detach()
  File "/usr/lib64/python3.9/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/usr/lib64/python3.9/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/usr/lib64/python3.9/multiprocessing/connection.py", line 506, in Client
    c = SocketClient(address)
  File "/usr/lib64/python3.9/multiprocessing/connection.py", line 634, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
Epochs:   6%|█████████                                                                                                                                     | 8/126 [06:12<1:31:36, 46.58s/it]
Traceback (most recent call last):
  File "/home/johnma/d-flow/train.py", line 117, in <module>
    loss = loss_fn(x) / accumulation_steps
  File "/home/johnma/d-flow/train.py", line 33, in loss_fn
    pred_vel = model(xt, t)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 655, in _fn
    return fn(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/unet/default.py", line 55, in forward
    def forward(self, x: torch.Tensor, t: torch.Tensor, labels = None):
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 829, in _fn
    @functools.wraps(fn)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/johnma/d-flow/train.py", line 117, in <module>
    loss = loss_fn(x) / accumulation_steps
  File "/home/johnma/d-flow/train.py", line 33, in loss_fn
    pred_vel = model(xt, t)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 655, in _fn
    return fn(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/johnma/d-flow/unet/default.py", line 55, in forward
    def forward(self, x: torch.Tensor, t: torch.Tensor, labels = None):
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 829, in _fn
    @functools.wraps(fn)
KeyboardInterrupt
