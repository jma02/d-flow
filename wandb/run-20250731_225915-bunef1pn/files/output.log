Train set shape: torch.Size([16000, 1, 32, 32])
Validation set shape: torch.Size([2000, 1, 32, 32])
Test set shape: torch.Size([2000, 1, 32, 32])
Traceback (most recent call last):
  File "/home/johnma/d-flow/train.py", line 109, in <module>
    step, curr_epoch, model, optim, scaler, ema_model = load_checkpoint(ckpt, model, optim, scaler, ema_model)
  File "/home/johnma/d-flow/utils.py", line 117, in load_checkpoint
    model.load_state_dict(checkpoint['model_state_dict'])
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for OptimizedModule:
	Missing key(s) in state_dict: "_orig_mod.input_proj.weight", "_orig_mod.input_proj.bias", "_orig_mod.time_proj.0.weight", "_orig_mod.time_proj.0.bias", "_orig_mod.time_proj.2.weight", "_orig_mod.time_proj.2.bias", "_orig_mod.down.0.0.block1.0.weight", "_orig_mod.down.0.0.block1.0.bias", "_orig_mod.down.0.0.block1.3.weight", "_orig_mod.down.0.0.block1.3.bias", "_orig_mod.down.0.0.block2.0.weight", "_orig_mod.down.0.0.block2.0.bias", "_orig_mod.down.0.0.block2.3.weight", "_orig_mod.down.0.0.block2.3.bias", "_orig_mod.down.0.0.cond_block.proj.1.weight", "_orig_mod.down.0.0.cond_block.proj.1.bias", "_orig_mod.down.0.1.block1.0.weight", "_orig_mod.down.0.1.block1.0.bias", "_orig_mod.down.0.1.block1.3.weight", "_orig_mod.down.0.1.block1.3.bias", "_orig_mod.down.0.1.block2.0.weight", "_orig_mod.down.0.1.block2.0.bias", "_orig_mod.down.0.1.block2.3.weight", "_orig_mod.down.0.1.block2.3.bias", "_orig_mod.down.0.1.cond_block.proj.1.weight", "_orig_mod.down.0.1.cond_block.proj.1.bias", "_orig_mod.down.0.2.conv.weight", "_orig_mod.down.0.2.conv.bias", "_orig_mod.down.1.0.block1.0.weight", "_orig_mod.down.1.0.block1.0.bias", "_orig_mod.down.1.0.block1.3.weight", "_orig_mod.down.1.0.block1.3.bias", "_orig_mod.down.1.0.block2.0.weight", "_orig_mod.down.1.0.block2.0.bias", "_orig_mod.down.1.0.block2.3.weight", "_orig_mod.down.1.0.block2.3.bias", "_orig_mod.down.1.0.cond_block.proj.1.weight", "_orig_mod.down.1.0.cond_block.proj.1.bias", "_orig_mod.down.1.0.attn.norm.weight", "_orig_mod.down.1.0.attn.norm.bias", "_orig_mod.down.1.0.attn.Q.weight", "_orig_mod.down.1.0.attn.Q.bias", "_orig_mod.down.1.0.attn.K.weight", "_orig_mod.down.1.0.attn.K.bias", "_orig_mod.down.1.0.attn.V.weight", "_orig_mod.down.1.0.attn.V.bias", "_orig_mod.down.1.0.attn.proj.weight", "_orig_mod.down.1.0.attn.proj.bias", "_orig_mod.down.1.1.block1.0.weight", "_orig_mod.down.1.1.block1.0.bias", "_orig_mod.down.1.1.block1.3.weight", "_orig_mod.down.1.1.block1.3.bias", "_orig_mod.down.1.1.block2.0.weight", "_orig_mod.down.1.1.block2.0.bias", "_orig_mod.down.1.1.block2.3.weight", "_orig_mod.down.1.1.block2.3.bias", "_orig_mod.down.1.1.cond_block.proj.1.weight", "_orig_mod.down.1.1.cond_block.proj.1.bias", "_orig_mod.down.1.1.attn.norm.weight", "_orig_mod.down.1.1.attn.norm.bias", "_orig_mod.down.1.1.attn.Q.weight", "_orig_mod.down.1.1.attn.Q.bias", "_orig_mod.down.1.1.attn.K.weight", "_orig_mod.down.1.1.attn.K.bias", "_orig_mod.down.1.1.attn.V.weight", "_orig_mod.down.1.1.attn.V.bias", "_orig_mod.down.1.1.attn.proj.weight", "_orig_mod.down.1.1.attn.proj.bias", "_orig_mod.down.1.2.conv.weight", "_orig_mod.down.1.2.conv.bias", "_orig_mod.down.2.0.block1.0.weight", "_orig_mod.down.2.0.block1.0.bias", "_orig_mod.down.2.0.block1.3.weight", "_orig_mod.down.2.0.block1.3.bias", "_orig_mod.down.2.0.block2.0.weight", "_orig_mod.down.2.0.block2.0.bias", "_orig_mod.down.2.0.block2.3.weight", "_orig_mod.down.2.0.block2.3.bias", "_orig_mod.down.2.0.cond_block.proj.1.weight", "_orig_mod.down.2.0.cond_block.proj.1.bias", "_orig_mod.down.2.0.attn.norm.weight", "_orig_mod.down.2.0.attn.norm.bias", "_orig_mod.down.2.0.attn.Q.weight", "_orig_mod.down.2.0.attn.Q.bias", "_orig_mod.down.2.0.attn.K.weight", "_orig_mod.down.2.0.attn.K.bias", "_orig_mod.down.2.0.attn.V.weight", "_orig_mod.down.2.0.attn.V.bias", "_orig_mod.down.2.0.attn.proj.weight", "_orig_mod.down.2.0.attn.proj.bias", "_orig_mod.down.2.1.block1.0.weight", "_orig_mod.down.2.1.block1.0.bias", "_orig_mod.down.2.1.block1.3.weight", "_orig_mod.down.2.1.block1.3.bias", "_orig_mod.down.2.1.block2.0.weight", "_orig_mod.down.2.1.block2.0.bias", "_orig_mod.down.2.1.block2.3.weight", "_orig_mod.down.2.1.block2.3.bias", "_orig_mod.down.2.1.cond_block.proj.1.weight", "_orig_mod.down.2.1.cond_block.proj.1.bias", "_orig_mod.down.2.1.attn.norm.weight", "_orig_mod.down.2.1.attn.norm.bias", "_orig_mod.down.2.1.attn.Q.weight", "_orig_mod.down.2.1.attn.Q.bias", "_orig_mod.down.2.1.attn.K.weight", "_orig_mod.down.2.1.attn.K.bias", "_orig_mod.down.2.1.attn.V.weight", "_orig_mod.down.2.1.attn.V.bias", "_orig_mod.down.2.1.attn.proj.weight", "_orig_mod
	Unexpected key(s) in state_dict: "input_proj.weight", "input_proj.bias", "time_proj.0.weight", "time_proj.0.bias", "time_proj.2.weight", "time_proj.2.bias", "down.0.0.block1.0.weight", "down.0.0.block1.0.bias", "down.0.0.block1.3.weight", "down.0.0.block1.3.bias", "down.0.0.block2.0.weight", "down.0.0.block2.0.bias", "down.0.0.block2.3.weight", "down.0.0.block2.3.bias", "down.0.0.cond_block.proj.1.weight", "down.0.0.cond_block.proj.1.bias", "down.0.1.block1.0.weight", "down.0.1.block1.0.bias", "down.0.1.block1.3.weight", "down.0.1.block1.3.bias", "down.0.1.block2.0.weight", "down.0.1.block2.0.bias", "down.0.1.block2.3.weight", "down.0.1.block2.3.bias", "down.0.1.cond_block.proj.1.weight", "down.0.1.cond_block.proj.1.bias", "down.0.2.conv.weight", "down.0.2.conv.bias", "down.1.0.block1.0.weight", "down.1.0.block1.0.bias", "down.1.0.block1.3.weight", "down.1.0.block1.3.bias", "down.1.0.block2.0.weight", "down.1.0.block2.0.bias", "down.1.0.block2.3.weight", "down.1.0.block2.3.bias", "down.1.0.cond_block.proj.1.weight", "down.1.0.cond_block.proj.1.bias", "down.1.0.attn.norm.weight", "down.1.0.attn.norm.bias", "down.1.0.attn.Q.weight", "down.1.0.attn.Q.bias", "down.1.0.attn.K.weight", "down.1.0.attn.K.bias", "down.1.0.attn.V.weight", "down.1.0.attn.V.bias", "down.1.0.attn.proj.weight", "down.1.0.attn.proj.bias", "down.1.1.block1.0.weight", "down.1.1.block1.0.bias", "down.1.1.block1.3.weight", "down.1.1.block1.3.bias", "down.1.1.block2.0.weight", "down.1.1.block2.0.bias", "down.1.1.block2.3.weight", "down.1.1.block2.3.bias", "down.1.1.cond_block.proj.1.weight", "down.1.1.cond_block.proj.1.bias", "down.1.1.attn.norm.weight", "down.1.1.attn.norm.bias", "down.1.1.attn.Q.weight", "down.1.1.attn.Q.bias", "down.1.1.attn.K.weight", "down.1.1.attn.K.bias", "down.1.1.attn.V.weight", "down.1.1.attn.V.bias", "down.1.1.attn.proj.weight", "down.1.1.attn.proj.bias", "down.1.2.conv.weight", "down.1.2.conv.bias", "down.2.0.block1.0.weight", "down.2.0.block1.0.bias", "down.2.0.block1.3.weight", "down.2.0.block1.3.bias", "down.2.0.block2.0.weight", "down.2.0.block2.0.bias", "down.2.0.block2.3.weight", "down.2.0.block2.3.bias", "down.2.0.cond_block.proj.1.weight", "down.2.0.cond_block.proj.1.bias", "down.2.0.attn.norm.weight", "down.2.0.attn.norm.bias", "down.2.0.attn.Q.weight", "down.2.0.attn.Q.bias", "down.2.0.attn.K.weight", "down.2.0.attn.K.bias", "down.2.0.attn.V.weight", "down.2.0.attn.V.bias", "down.2.0.attn.proj.weight", "down.2.0.attn.proj.bias", "down.2.1.block1.0.weight", "down.2.1.block1.0.bias", "down.2.1.block1.3.weight", "down.2.1.block1.3.bias", "down.2.1.block2.0.weight", "down.2.1.block2.0.bias", "down.2.1.block2.3.weight", "down.2.1.block2.3.bias", "down.2.1.cond_block.proj.1.weight", "down.2.1.cond_block.proj.1.bias", "down.2.1.attn.norm.weight", "down.2.1.attn.norm.bias", "down.2.1.attn.Q.weight", "down.2.1.attn.Q.bias", "down.2.1.attn.K.weight", "down.2.1.attn.K.bias", "down.2.1.attn.V.weight", "down.2.1.attn.V.bias", "down.2.1.attn.proj.weight", "down.2.1.attn.proj.bias", "down.2.2.conv.weight", "down.2.2.conv.bias", "down.3.0.block1.0.weight", "down.3.0.block1.0.bias", "down.3.0.block1.3.weight", "down.3.0.block1.3.bias", "down.3.0.block2.0.weight", "down.3.0.block2.0.bias", "down.3.0.block2.3.weight", "down.3.0.block2.3.bias", "down.3.0.cond_block.proj.1.weight", "down.3.0.cond_block.proj.1.bias", "down.3.1.block1.0.weight", "down.3.1.block1.0.bias", "down.3.1.block1.3.weight", "down.3.1.block1.3.bias", "down.3.1.block2.0.weight", "down.3.1.block2.0.bias", "down.3.1.block2.3.weight", "down.3.1.block2.3.bias", "down.3.1.cond_block.proj.1.weight", "down.3.1.cond_block.proj.1.bias", "up.0.0.skip_connection.weight", "up.0.0.skip_connection.bias", "up.0.0.block1.0.weight", "up.0.0.block1.0.bias", "up.0.0.block1.3.weight", "up.0.0.block1.3.bias", "up.0.0.block2.0.weight", "up.0.0.block2.0.bias", "up.0.0.block2.3.weight", "up.0.0.block2.3.bias", "up.0.0.cond_block.proj.1.weight", "up.0.0.cond_block.proj.1.bias", "up.0.1.skip_connection.weight", "up.0.1.skip_connection.bias", "up.0.1.block1.0.weight", "up.0.1.block1.0.bias", "u
Traceback (most recent call last):
  File "/home/johnma/d-flow/train.py", line 109, in <module>
    step, curr_epoch, model, optim, scaler, ema_model = load_checkpoint(ckpt, model, optim, scaler, ema_model)
  File "/home/johnma/d-flow/utils.py", line 117, in load_checkpoint
    model.load_state_dict(checkpoint['model_state_dict'])
  File "/home/johnma/d-flow/venv/lib64/python3.9/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for OptimizedModule:
	Missing key(s) in state_dict: "_orig_mod.input_proj.weight", "_orig_mod.input_proj.bias", "_orig_mod.time_proj.0.weight", "_orig_mod.time_proj.0.bias", "_orig_mod.time_proj.2.weight", "_orig_mod.time_proj.2.bias", "_orig_mod.down.0.0.block1.0.weight", "_orig_mod.down.0.0.block1.0.bias", "_orig_mod.down.0.0.block1.3.weight", "_orig_mod.down.0.0.block1.3.bias", "_orig_mod.down.0.0.block2.0.weight", "_orig_mod.down.0.0.block2.0.bias", "_orig_mod.down.0.0.block2.3.weight", "_orig_mod.down.0.0.block2.3.bias", "_orig_mod.down.0.0.cond_block.proj.1.weight", "_orig_mod.down.0.0.cond_block.proj.1.bias", "_orig_mod.down.0.1.block1.0.weight", "_orig_mod.down.0.1.block1.0.bias", "_orig_mod.down.0.1.block1.3.weight", "_orig_mod.down.0.1.block1.3.bias", "_orig_mod.down.0.1.block2.0.weight", "_orig_mod.down.0.1.block2.0.bias", "_orig_mod.down.0.1.block2.3.weight", "_orig_mod.down.0.1.block2.3.bias", "_orig_mod.down.0.1.cond_block.proj.1.weight", "_orig_mod.down.0.1.cond_block.proj.1.bias", "_orig_mod.down.0.2.conv.weight", "_orig_mod.down.0.2.conv.bias", "_orig_mod.down.1.0.block1.0.weight", "_orig_mod.down.1.0.block1.0.bias", "_orig_mod.down.1.0.block1.3.weight", "_orig_mod.down.1.0.block1.3.bias", "_orig_mod.down.1.0.block2.0.weight", "_orig_mod.down.1.0.block2.0.bias", "_orig_mod.down.1.0.block2.3.weight", "_orig_mod.down.1.0.block2.3.bias", "_orig_mod.down.1.0.cond_block.proj.1.weight", "_orig_mod.down.1.0.cond_block.proj.1.bias", "_orig_mod.down.1.0.attn.norm.weight", "_orig_mod.down.1.0.attn.norm.bias", "_orig_mod.down.1.0.attn.Q.weight", "_orig_mod.down.1.0.attn.Q.bias", "_orig_mod.down.1.0.attn.K.weight", "_orig_mod.down.1.0.attn.K.bias", "_orig_mod.down.1.0.attn.V.weight", "_orig_mod.down.1.0.attn.V.bias", "_orig_mod.down.1.0.attn.proj.weight", "_orig_mod.down.1.0.attn.proj.bias", "_orig_mod.down.1.1.block1.0.weight", "_orig_mod.down.1.1.block1.0.bias", "_orig_mod.down.1.1.block1.3.weight", "_orig_mod.down.1.1.block1.3.bias", "_orig_mod.down.1.1.block2.0.weight", "_orig_mod.down.1.1.block2.0.bias", "_orig_mod.down.1.1.block2.3.weight", "_orig_mod.down.1.1.block2.3.bias", "_orig_mod.down.1.1.cond_block.proj.1.weight", "_orig_mod.down.1.1.cond_block.proj.1.bias", "_orig_mod.down.1.1.attn.norm.weight", "_orig_mod.down.1.1.attn.norm.bias", "_orig_mod.down.1.1.attn.Q.weight", "_orig_mod.down.1.1.attn.Q.bias", "_orig_mod.down.1.1.attn.K.weight", "_orig_mod.down.1.1.attn.K.bias", "_orig_mod.down.1.1.attn.V.weight", "_orig_mod.down.1.1.attn.V.bias", "_orig_mod.down.1.1.attn.proj.weight", "_orig_mod.down.1.1.attn.proj.bias", "_orig_mod.down.1.2.conv.weight", "_orig_mod.down.1.2.conv.bias", "_orig_mod.down.2.0.block1.0.weight", "_orig_mod.down.2.0.block1.0.bias", "_orig_mod.down.2.0.block1.3.weight", "_orig_mod.down.2.0.block1.3.bias", "_orig_mod.down.2.0.block2.0.weight", "_orig_mod.down.2.0.block2.0.bias", "_orig_mod.down.2.0.block2.3.weight", "_orig_mod.down.2.0.block2.3.bias", "_orig_mod.down.2.0.cond_block.proj.1.weight", "_orig_mod.down.2.0.cond_block.proj.1.bias", "_orig_mod.down.2.0.attn.norm.weight", "_orig_mod.down.2.0.attn.norm.bias", "_orig_mod.down.2.0.attn.Q.weight", "_orig_mod.down.2.0.attn.Q.bias", "_orig_mod.down.2.0.attn.K.weight", "_orig_mod.down.2.0.attn.K.bias", "_orig_mod.down.2.0.attn.V.weight", "_orig_mod.down.2.0.attn.V.bias", "_orig_mod.down.2.0.attn.proj.weight", "_orig_mod.down.2.0.attn.proj.bias", "_orig_mod.down.2.1.block1.0.weight", "_orig_mod.down.2.1.block1.0.bias", "_orig_mod.down.2.1.block1.3.weight", "_orig_mod.down.2.1.block1.3.bias", "_orig_mod.down.2.1.block2.0.weight", "_orig_mod.down.2.1.block2.0.bias", "_orig_mod.down.2.1.block2.3.weight", "_orig_mod.down.2.1.block2.3.bias", "_orig_mod.down.2.1.cond_block.proj.1.weight", "_orig_mod.down.2.1.cond_block.proj.1.bias", "_orig_mod.down.2.1.attn.norm.weight", "_orig_mod.down.2.1.attn.norm.bias", "_orig_mod.down.2.1.attn.Q.weight", "_orig_mod.down.2.1.attn.Q.bias", "_orig_mod.down.2.1.attn.K.weight", "_orig_mod.down.2.1.attn.K.bias", "_orig_mod.down.2.1.attn.V.weight", "_orig_mod.down.2.1.attn.V.bias", "_orig_mod.down.2.1.attn.proj.weight", "_orig_mod
	Unexpected key(s) in state_dict: "input_proj.weight", "input_proj.bias", "time_proj.0.weight", "time_proj.0.bias", "time_proj.2.weight", "time_proj.2.bias", "down.0.0.block1.0.weight", "down.0.0.block1.0.bias", "down.0.0.block1.3.weight", "down.0.0.block1.3.bias", "down.0.0.block2.0.weight", "down.0.0.block2.0.bias", "down.0.0.block2.3.weight", "down.0.0.block2.3.bias", "down.0.0.cond_block.proj.1.weight", "down.0.0.cond_block.proj.1.bias", "down.0.1.block1.0.weight", "down.0.1.block1.0.bias", "down.0.1.block1.3.weight", "down.0.1.block1.3.bias", "down.0.1.block2.0.weight", "down.0.1.block2.0.bias", "down.0.1.block2.3.weight", "down.0.1.block2.3.bias", "down.0.1.cond_block.proj.1.weight", "down.0.1.cond_block.proj.1.bias", "down.0.2.conv.weight", "down.0.2.conv.bias", "down.1.0.block1.0.weight", "down.1.0.block1.0.bias", "down.1.0.block1.3.weight", "down.1.0.block1.3.bias", "down.1.0.block2.0.weight", "down.1.0.block2.0.bias", "down.1.0.block2.3.weight", "down.1.0.block2.3.bias", "down.1.0.cond_block.proj.1.weight", "down.1.0.cond_block.proj.1.bias", "down.1.0.attn.norm.weight", "down.1.0.attn.norm.bias", "down.1.0.attn.Q.weight", "down.1.0.attn.Q.bias", "down.1.0.attn.K.weight", "down.1.0.attn.K.bias", "down.1.0.attn.V.weight", "down.1.0.attn.V.bias", "down.1.0.attn.proj.weight", "down.1.0.attn.proj.bias", "down.1.1.block1.0.weight", "down.1.1.block1.0.bias", "down.1.1.block1.3.weight", "down.1.1.block1.3.bias", "down.1.1.block2.0.weight", "down.1.1.block2.0.bias", "down.1.1.block2.3.weight", "down.1.1.block2.3.bias", "down.1.1.cond_block.proj.1.weight", "down.1.1.cond_block.proj.1.bias", "down.1.1.attn.norm.weight", "down.1.1.attn.norm.bias", "down.1.1.attn.Q.weight", "down.1.1.attn.Q.bias", "down.1.1.attn.K.weight", "down.1.1.attn.K.bias", "down.1.1.attn.V.weight", "down.1.1.attn.V.bias", "down.1.1.attn.proj.weight", "down.1.1.attn.proj.bias", "down.1.2.conv.weight", "down.1.2.conv.bias", "down.2.0.block1.0.weight", "down.2.0.block1.0.bias", "down.2.0.block1.3.weight", "down.2.0.block1.3.bias", "down.2.0.block2.0.weight", "down.2.0.block2.0.bias", "down.2.0.block2.3.weight", "down.2.0.block2.3.bias", "down.2.0.cond_block.proj.1.weight", "down.2.0.cond_block.proj.1.bias", "down.2.0.attn.norm.weight", "down.2.0.attn.norm.bias", "down.2.0.attn.Q.weight", "down.2.0.attn.Q.bias", "down.2.0.attn.K.weight", "down.2.0.attn.K.bias", "down.2.0.attn.V.weight", "down.2.0.attn.V.bias", "down.2.0.attn.proj.weight", "down.2.0.attn.proj.bias", "down.2.1.block1.0.weight", "down.2.1.block1.0.bias", "down.2.1.block1.3.weight", "down.2.1.block1.3.bias", "down.2.1.block2.0.weight", "down.2.1.block2.0.bias", "down.2.1.block2.3.weight", "down.2.1.block2.3.bias", "down.2.1.cond_block.proj.1.weight", "down.2.1.cond_block.proj.1.bias", "down.2.1.attn.norm.weight", "down.2.1.attn.norm.bias", "down.2.1.attn.Q.weight", "down.2.1.attn.Q.bias", "down.2.1.attn.K.weight", "down.2.1.attn.K.bias", "down.2.1.attn.V.weight", "down.2.1.attn.V.bias", "down.2.1.attn.proj.weight", "down.2.1.attn.proj.bias", "down.2.2.conv.weight", "down.2.2.conv.bias", "down.3.0.block1.0.weight", "down.3.0.block1.0.bias", "down.3.0.block1.3.weight", "down.3.0.block1.3.bias", "down.3.0.block2.0.weight", "down.3.0.block2.0.bias", "down.3.0.block2.3.weight", "down.3.0.block2.3.bias", "down.3.0.cond_block.proj.1.weight", "down.3.0.cond_block.proj.1.bias", "down.3.1.block1.0.weight", "down.3.1.block1.0.bias", "down.3.1.block1.3.weight", "down.3.1.block1.3.bias", "down.3.1.block2.0.weight", "down.3.1.block2.0.bias", "down.3.1.block2.3.weight", "down.3.1.block2.3.bias", "down.3.1.cond_block.proj.1.weight", "down.3.1.cond_block.proj.1.bias", "up.0.0.skip_connection.weight", "up.0.0.skip_connection.bias", "up.0.0.block1.0.weight", "up.0.0.block1.0.bias", "up.0.0.block1.3.weight", "up.0.0.block1.3.bias", "up.0.0.block2.0.weight", "up.0.0.block2.0.bias", "up.0.0.block2.3.weight", "up.0.0.block2.3.bias", "up.0.0.cond_block.proj.1.weight", "up.0.0.cond_block.proj.1.bias", "up.0.1.skip_connection.weight", "up.0.1.skip_connection.bias", "up.0.1.block1.0.weight", "up.0.1.block1.0.bias", "u
